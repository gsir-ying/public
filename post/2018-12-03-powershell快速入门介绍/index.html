<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>powershell快速入门介绍 - Gsir</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="GSir" /><meta name="description" content="介绍powershell的特性、IDE、常用语法。 简介 Windows Powershell 是运行在windows机器上实现系统和应用程序管理自动化的命令行脚本环境。可以把它" /><meta name="keywords" content="GNSS, 算法研究, 数据处理, 程序人生, 博客人生" />






<meta name="generator" content="Hugo 0.50 with even 4.0.0" />


<link rel="canonical" href="gsir.top/post/2018-12-03-powershell%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BB%8B%E7%BB%8D/" />
<link rel="apple-touch-icon" sizes="180x180" href="/gsir.top/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/gsir.top/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/gsir.top/favicon-16x16.png">
<link rel="manifest" href="/gsir.top/manifest.json">
<link rel="mask-icon" href="/gsir.top/safari-pinned-tab.svg" color="#5bbad5">


<link href="/gsir.top/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="powershell快速入门介绍" />
<meta property="og:description" content="介绍powershell的特性、IDE、常用语法。 简介 Windows Powershell 是运行在windows机器上实现系统和应用程序管理自动化的命令行脚本环境。可以把它" />
<meta property="og:type" content="article" />
<meta property="og:url" content="gsir.top/post/2018-12-03-powershell%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E4%BB%8B%E7%BB%8D/" /><meta property="article:published_time" content="2018-12-03T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-12-03T00:00:00&#43;00:00"/>

<meta itemprop="name" content="powershell快速入门介绍">
<meta itemprop="description" content="介绍powershell的特性、IDE、常用语法。 简介 Windows Powershell 是运行在windows机器上实现系统和应用程序管理自动化的命令行脚本环境。可以把它">


<meta itemprop="datePublished" content="2018-12-03T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-12-03T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="2258">



<meta itemprop="keywords" content="powershell," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="powershell快速入门介绍"/>
<meta name="twitter:description" content="介绍powershell的特性、IDE、常用语法。 简介 Windows Powershell 是运行在windows机器上实现系统和应用程序管理自动化的命令行脚本环境。可以把它"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/gsir.top/" class="logo">碧海青天夜夜心</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="gsir.top/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="gsir.top/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="gsir.top/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="gsir.top/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="gsir.top/links/">
        <li class="mobile-menu-item">链接</li>
      </a><a href="gsir.top/downloads/">
        <li class="mobile-menu-item">下载</li>
      </a><a href="gsir.top/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/gsir.top/" class="logo">碧海青天夜夜心</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="gsir.top/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="gsir.top/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="gsir.top/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="gsir.top/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="gsir.top/links/">链接</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="gsir.top/downloads/">下载</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="gsir.top/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">powershell快速入门介绍</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-12-03 </span>
        <div class="post-category">
            <a href="/gsir.top/categories/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"> 程序人生 </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#ide">IDE</a>
<ul>
<li><a href="#vscode">vscode</a></li>
<li><a href="#windows-powershell-ise">Windows PowerShell ISE</a></li>
<li><a href="#powershell-studio">PowerShell Studio</a></li>
</ul></li>
<li><a href="#使用介绍">使用介绍</a>
<ul>
<li><a href="#命令介绍">命令介绍</a></li>
<li><a href="#获取命令">获取命令</a></li>
<li><a href="#获取别名">获取别名</a></li>
<li><a href="#获取帮助">获取帮助</a>
<ul>
<li><a href="#office互操作">Office互操作</a></li>
</ul></li>
<li><a href="#界面美化">界面美化</a></li>
</ul></li>
<li><a href="#常用命令语法介绍">常用命令语法介绍</a></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<blockquote>
<p>介绍powershell的特性、IDE、常用语法。</p>
</blockquote>

<h1 id="简介">简介</h1>

<p>Windows Powershell 是运行在windows机器上实现系统和应用程序管理自动化的命令行脚本环境。可以把它看成是命令行提示符cmd.exe的扩充，不对，应当是颠覆。 powershell需要.NET环境的支持，同时支持.NET对象。微软之所以将Powershell 定位为Power，并不是夸大其词，因为它完全支持对象。其可读性，易用性，可以位居当前所有shell之首。</p>

<p>PowerShell Core是一个跨平台（Windows，Linux和macOS）自动化和配置工具/框架，可与您现有的工具配合使用，并针对结构化数据（例如JSON，CSV，XML等），REST API进行了优化和对象模型。它包括命令行shell，关联的脚本语言和用于处理cmdlet的框架。</p>

<h1 id="ide">IDE</h1>

<h2 id="vscode">vscode</h2>

<p>powershell是vscode的一个插件，搜索安装即可。支持代码智能提示、缩进、代码调试和运行等功能。</p>

<h2 id="windows-powershell-ise">Windows PowerShell ISE</h2>

<p>Windows PowerShell 集成脚本环境 (ISE) 是 Windows PowerShell 的主机应用程序。在 Windows PowerShell ISE 中，可以在单一 Windows 图形用户界面中运行命令以及编写、测试和调试脚本，该用户界面具有多行编辑、Tab 补齐、语法着色、选择性执行、上下文相关帮助等功能，而且还支持从右到左书写语言。此主机应用程序最多还可以包括八个会话。 可以自定义 Windows PowerShell ISE 的外观。Windows PowerShell ISE 还有自己的 Windows PowerShell 配置文件，您可以在其中存储在 Windows PowerShell ISE 中使用的函数、别名、变量和命令。</p>

<h2 id="powershell-studio">PowerShell Studio</h2>

<p>PowerShell Studio是适用于Windows PowerShell的最佳编辑器和工具之一。什么是PowerShell？也许大家用命令CMD，你知道命令提示符窗口，这意味着从Windows NT的早期使用相同的语法DOS的人站立于Windows图形环境，使用它可以通过同样的事情被限制了我们通过Windows窗口以图形方式执行。微软后来得出结论，Windows环境值得一个更强大的终端，这导致了PowerShell演示文稿。</p>

<h1 id="使用介绍">使用介绍</h1>

<h2 id="命令介绍">命令介绍</h2>

<p>Powershell 的命令基本上都是动词-名词形式的，所见即所得，方便记忆。</p>

<p>Powershell 和Linux Shell 还有一个不同点在于Powershell 是基于 .NET平台的，它的命令叫做cmdlet。cmdlet功能比普通的Linux 命令更强，因为cmdlet接受的参数不是字符串，而是 .NET 对象，这使得Powershell 的功能更加强大和灵活。</p>

<h2 id="获取命令">获取命令</h2>

<p>如果想要获取当前会话中所有可用的内置命令，可以使用命令Get-Command，它的别名是gcm。</p>

<h2 id="获取别名">获取别名</h2>

<p>Windows PowerShell 具有几个转换别名，允许 UNIX 和 Cmd 用户在 Windows PowerShell 中使用熟悉的命令名称。下表列出了最常用的别名以及别名背后的 Windows PowerShell 命令和标准的 Windows PowerShell 别名（如果存在）。</p>

<p>使用 Get-Alias cmdlet 可以从 Windows PowerShell 中查找任何别名所指向的 Windows PowerShell 命令。例如，键入 get-alias cls。</p>

<p><img src="../images/2018120301.png" alt="" /></p>

<h2 id="获取帮助">获取帮助</h2>

<p>如果要获取一个命令的帮助，可以使用Get-Help。如果使用上面介绍的列出别名的命令的话，会发现这个命令的别名是man，恰好就是Linux 系统下的获取帮助的命令。当然它们的功能也很相似。</p>

<p>##应用实例</p>

<p>从网上找了个例子来看看Powershell的实际作用。我们可以从中了解到Powershell的强大特性，用它帮助我们方便地管理Windows操作系统。</p>

<p>贴一个网络上的例子。运行一下会直接打开Excel并填充数据，然后画出占用内存前十的程序的饼状图。</p>

<h3 id="office互操作">Office互操作</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></pre></td>
<td class="lntd">
<pre class="chroma"># create new excel instance
 $objExcel = New-Object -comobject Excel.Application
 $objExcel.Visible = $True
 $objWorkbook = $objExcel.Workbooks.Add()
 $objWorksheet = $objWorkbook.Worksheets.Item(1)

 # write information to the excel file
$i = 0
$first10 = (ps | sort ws -Descending | select -first 10)
$first10 | foreach -Process {$i++; $objWorksheet.Cells.Item($i,1) = $_.name; $objWorksheet.Cells.Item($i,2) = $_.ws}
$otherMem = (ps | measure ws -s).Sum - ($first10 | measure ws -s).Sum
$objWorksheet.Cells.Item(11,1) = &#34;Others&#34;; $objWorksheet.Cells.Item(11,2) = $otherMem

# draw the pie chart
$objCharts = $objWorksheet.ChartObjects()
$objChart = $objCharts.Add(0, 0, 500, 300)
$objChart.Chart.SetSourceData($objWorksheet.range(&#34;A1:B11&#34;), 2)
$objChart.Chart.ChartType = 70
$objChart.Chart.ApplyDataLabels(5)</pre></td></tr></table>
</div>
</div>
<p>结果如下图
<img src="../images/2018120302.png" alt="" /></p>

<h2 id="界面美化">界面美化</h2>

<p>可使用<a href="https://github.com/JanDeDobbeleer/oh-my-posh">oh-my-posh</a>和<a href="http://cmder.net/">cmder</a></p>

<h1 id="常用命令语法介绍">常用命令语法介绍</h1>

<p>参考1 <a href="https://blog.csdn.net/mr_pang/article/details/50571866">https://blog.csdn.net/mr_pang/article/details/50571866</a></p>

<p>参考2 <a href="https://www.cnblogs.com/chsword/archive/2011/10/17/PowerShell_3.html">https://www.cnblogs.com/chsword/archive/2011/10/17/PowerShell_3.html</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></pre></td>
<td class="lntd">
<pre class="chroma">注释
•#语句

•&lt;# 语句 #&gt;

变量
•命名法则 $ 做为前缀

•使用字母、数字、下划线均可

•查看所有变量 Get-ChildItem variable:或Get-Varialbe

•获取作用域变量Get-Variable –Scope [Local|Global]

•实例化对象 $dt=New-Object DateTime

数组
•定义$arr=1,2,3,4

•$arr=1..4

•取值 $arr[1,3]、 $arr[1,3+2]、 $arr[1..3+2]

•赋值 $a,$b=1,2、 $b,$a=$a,$b

•运算符 +操作符进行数组合并

•比较运算符可筛选数组内容

Hashtable
•PowerShell中自然集成Hashtable

•定义方式 @{a=1;b=“t”}

•合并操作符@{a=1}+@{b=2}

•取值 $ht=@{a=1} 则使用$ht[“a”] $ht.a均可

•其它操作方法与CRL对象一致

字符串/其它对象
•多行字符串 @”....”@

•字符转义`符号如”`n”

•字符串复制 “a”*2

•将字符串转为XML对象[xml]&#34;&lt;a&gt;12&lt;/a&gt;&#34;

过程控制
•if(){}elseif{}else{}

•switch(){value1{…;break}value2{….;break}}

•foreach($xxx in $yyy){}

•for($i=0;$i –le 100;$i++){}

•while(){}

•do{}while()

•do{}until()

方法
function methodName {

param ($size)#参数

#执行的语句

}

或

function methodName ($p){

#执行的语句

}

CLR/DLR对象
•Static成员访问 [DateTime]::Now

•实例化 $dt=new-object DateTime(1999,9,9);

•实例成员的访问 $dt.AddDays(100)

•泛型类型的使用 $l=new-object System.Collections.Generic.List[int]

•获取对象的所有成员 Get-Member –InputObject $l</pre></td></tr></table>
</div>
</div>
<blockquote>
<p>powershell的强大在不断学习和使用过程中会慢慢体会到。不断学习！不断进步！</p>
</blockquote>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">GSir</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">2018-12-03</span>
  </p>
  
  
</div><div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="../images/wechat.png">
        <span>微信打赏</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="../images/alipay.png">
        <span>支付宝打赏</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/gsir.top/tags/powershell/">powershell</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="gsir.top/post/2018-12-03-linux%E5%AE%89%E8%A3%85powershell/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Linux安装powershell</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="gsir.top/post/2018-12-02-gnss%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/">
            <span class="next-text nav-default">GNSS数据预处理工具</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'Gsir';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:gsir_ying@163.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/gsir-ying" class="iconfont icon-github" title="github"></a>
      <a href="http://blog.sina.com.cn/u/5651674758" class="iconfont icon-weibo" title="weibo"></a>
  <a href="gsir.top/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2018 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Gsir</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/gsir.top/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/gsir.top/dist/even.26188efa.min.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: {equationNumbers: {autoNumber: "AMS"}},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
